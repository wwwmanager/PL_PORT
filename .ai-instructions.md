# APPLICATION CONTEXT

## 1. –û–±—â–∏–π –æ–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

- **–ù–∞–∑–≤–∞–Ω–∏–µ:** Waybill App  
- **–í–µ—Ä—Å–∏—è:** 1.0.0  
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–≤—ã–º–∏ –ª–∏—Å—Ç–∞–º–∏, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º, –≤–æ–¥–∏—Ç–µ–ª—è–º–∏, –±–ª–∞–Ω–∫–∞–º–∏ –∏ —Å–∫–ª–∞–¥–æ–º –¥–ª—è –∞–≤—Ç–æ–ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π.  
- **–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:** –°–º–µ—à–∞–Ω–Ω—ã–π ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–∫–∏ (`mockApi.ts`) + –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Backend API.

---

## 2. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Frontend (–¥–∞–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π)

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|--------|------------|
| React | 19.2 | UI –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ |
| TypeScript | 5.2 | –¢–∏–ø–∏–∑–∞—Ü–∏—è |
| Vite | 5.2 | –°–±–æ—Ä–∫–∞ & Dev Server |
| React Hook Form | 7.51 | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞–º–∏ |
| Zod | 3.22 | –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º |
| @tanstack/react-query | 5.51 | –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–ø—Ä–æ—Å—ã |
| Recharts | 2.12 | –ì—Ä–∞—Ñ–∏–∫–∏ |
| @dnd-kit | 6.x/8.x | Drag & Drop |
| xlsx | 0.18 | Excel —ç–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç |

**–°—Ç–∏–ª–∏:** Vanilla CSS + inline Tailwind-–ø–æ–¥–æ–±–Ω—ã–µ –∫–ª–∞—Å—Å—ã (–±–µ–∑ Tailwind config).

**–¢–µ—Å—Ç—ã:** Vitest + Testing Library.

**–ó–∞–ø—É—Å–∫ dev:** `npm run dev` ‚Üí http://localhost:5173/

### Backend (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä)

- **Express** + **TypeScript** + **Prisma/TypeORM** (–ø–æ—Ä—Ç 3001)
- **PostgreSQL** ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –ë–î
- **JWT** –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

> ‚ö†Ô∏è –í –¥–∞–Ω–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ backend –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `mockApi.ts` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

---

## 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
c:/_PL_PORT/
‚îú‚îÄ‚îÄ App.tsx              # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îú‚îÄ‚îÄ components/          # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (74+)
‚îÇ   ‚îú‚îÄ‚îÄ admin/           # –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ shared/          # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ (Modal, DataTable...)
‚îÇ   ‚îú‚îÄ‚îÄ vehicles/        # –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç
‚îÇ   ‚îú‚îÄ‚îÄ waybills/        # –ü—É—Ç–µ–≤—ã–µ –ª–∏—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ api/             # API —Ñ–∞—Å–∞–¥—ã (waybills.ts, vehicles.ts...)
‚îÇ   ‚îú‚îÄ‚îÄ mockApi.ts       # –õ–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ batchWaybillService.ts
‚îÇ   ‚îú‚îÄ‚îÄ recalculationService.ts
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ shared/              # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ vehicleInput.ts  # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–≤–æ–¥–∞ –¢–°
‚îÇ   ‚îú‚îÄ‚îÄ vehicleCategoryMap.ts
‚îÇ   ‚îî‚îÄ‚îÄ validation/
‚îú‚îÄ‚îÄ hooks/               # React —Ö—É–∫–∏ (useTable, queries...)
‚îú‚îÄ‚îÄ types.ts             # –û–±—â–∏–µ —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ constants.ts         # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã (—Å—Ç–∞—Ç—É—Å—ã, —Ü–≤–µ—Ç–∞)
‚îî‚îÄ‚îÄ utils/               # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
```

---

## 4. API Endpoints

> –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å backend (–Ω–µ mockApi):

| –†–µ—Å—É—Ä—Å | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| –ü—É—Ç–µ–≤—ã–µ –ª–∏—Å—Ç—ã | `/api/waybills` | CRUD, —Å–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ |
| –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç | `/api/vehicles` | CRUD |
| –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ | `/api/employees` | CRUD, —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É |
| –ë–ª–∞–Ω–∫–∏ | `/api/blanks` | –ü–∞—Ä—Ç–∏–∏, –≤—ã–¥–∞—á–∞ |
| –°–∫–ª–∞–¥ | `/api/stock` | –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞, –¥–≤–∏–∂–µ–Ω–∏—è |
| Dashboard | `/api/dashboard` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |

---

## 5. –ö–ª—é—á–µ–≤—ã–µ –º–æ–¥—É–ª–∏

### 5.1. –ü—É—Ç–µ–≤—ã–µ –ª–∏—Å—Ç—ã (Waybills)
- `services/api/waybills.ts` ‚Äî API –º–µ—Ç–æ–¥—ã
- `components/waybills/WaybillList.tsx` ‚Äî —Å–ø–∏—Å–æ–∫
- `components/waybills/WaybillDetail.tsx` ‚Äî —Ñ–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `services/batchWaybillService.ts` ‚Äî –ø–∞–∫–µ—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- `services/recalculationService.ts` ‚Äî –ø–µ—Ä–µ—Å—á–µ—Ç —Ç–æ–ø–ª–∏–≤–∞

### 5.2. –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç (Vehicles)
- `services/api/vehicles.ts` ‚Äî API –º–µ—Ç–æ–¥—ã
- `components/vehicles/VehicleList.tsx` ‚Äî —Å–ø–∏—Å–æ–∫ + —Ñ–æ—Ä–º–∞
- `shared/vehicleInput.ts` ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–≤–æ–¥–∞ (–≥–æ—Å–Ω–æ–º–µ—Ä, VIN)
- `shared/vehicleCategoryMap.ts` ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–π –æ—Ç —Ç–∏–ø–∞ –¢–°

### 5.3. –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
- `components/shared/Modal.tsx` ‚Äî –±–∞–∑–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (drag & resize)
- `components/shared/ConfirmationModal.tsx`

---

## 6. AI Session Rules

### 6.1. –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Å—Å–∏–∏

AI –æ–±—è–∑–∞–Ω:
1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª (`.ai-instructions.md`)
2. –ü—Ä–æ—á–∏—Ç–∞—Ç—å `Tasks/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã)
3. –°–æ–æ–±—â–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

### 6.2. –§–æ—Ä–º–∞—Ç –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

```
–ö–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–≥—Ä—É–∂–µ–Ω:
- .ai-instructions.md –ø—Ä–æ—á–∏—Ç–∞–Ω
- –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑–≤–µ—Å—Ç–Ω–∞

–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ. –ö–∞–∫—É—é –∑–∞–¥–∞—á—É –≤—ã–ø–æ–ª–Ω—è–µ–º?
```

### 6.3. –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã —Å –∫–æ–¥–æ–º

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Zod —Å—Ö–µ–º—ã. –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ö–µ–º—ã –≤ `components/*/...Schema.ts`.
2. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–≤–æ–¥–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ `shared/vehicleInput.ts`.
3. **–§–æ—Ä–º—ã:** React Hook Form + `useController` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã—Ö –ø–æ–ª–µ–π.
4. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:** `useToast` —Ö—É–∫.
5. **–ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `Modal` —Å props `isDraggable`, `isResizable`, `maxWidth`.

### 6.4. –†–∞—Å—á–µ—Ç —Ç–æ–ø–ª–∏–≤–∞

> ‚ö†Ô∏è `fuelCalculationService.ts` –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –¥–∞–Ω–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

–õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —Ç–æ–ø–ª–∏–≤–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∞:
- `services/recalculationService.ts` ‚Äî –ø–µ—Ä–µ—Å—á–µ—Ç —Ü–µ–ø–æ—á–∫–∏
- `services/batchWaybillService.ts` ‚Äî –ø–∞–∫–µ—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `components/waybills/WaybillDetail.tsx` ‚Äî UI —Ä–∞—Å—á–µ—Ç—ã

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ª–æ–≥–∏–∫–∏ —Ç–æ–ø–ª–∏–≤–∞ ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ç—Ä–∏ –º–µ—Å—Ç–∞.

---

## 7. –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –ù–µ–¥–∞–≤–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å vehicleCategory –æ—Ç vehicleType
- Controlled Inputs —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π (–≥–æ—Å–Ω–æ–º–µ—Ä, VIN)
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –º–æ–¥–∞–ª–æ–∫ (GPU acceleration)
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –£–¢–ú –¥–ª—è —Å–ø–µ—Ü—Ç–µ—Ö–Ω–∏–∫–∏

### üìã –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- `mockApi.ts` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- CSS —Å—Ç–∏–ª–∏ ‚Äî inline –∫–ª–∞—Å—Å—ã (Tailwind-like), –Ω–æ –±–µ–∑ Tailwind –∫–æ–Ω—Ñ–∏–≥–∞
- Backend ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–Ω–µ –≤ —ç—Ç–æ–π –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ)

---

## History

- **2026-01-15:** VEHICLE-CAT-001 ‚Äî –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å vehicleCategory –æ—Ç vehicleType. –î–æ–±–∞–≤–ª–µ–Ω—ã –£–¢–ú –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π dropdown, –∞–≤—Ç–æ—Å–±—Ä–æ—Å.
- **2026-01-15:** VEHICLE-INPUT-001 ‚Äî Controlled Inputs —Å –∞–≤—Ç–æ-–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞‚Üí–ª–∞—Ç–∏–Ω–∏—Ü–∞) –¥–ª—è –≥–æ—Å–Ω–æ–º–µ—Ä–∞, VIN, –∫—É–∑–æ–≤–∞, —à–∞—Å—Å–∏.
- **2026-01-15:** MODAL-PERF-001 ‚Äî –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –º–æ–¥–∞–ª–æ–∫: GPU acceleration, –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ transitions.
- **2025-12-31:** UI-DESIGN-007 ‚Äî –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ü–≤–µ—Ç–æ–≤–æ–π —Å—Ö–µ–º—ã (teal-600).

---

=== END OF PROJECT CONTEXT ===
